const _isJSON=function(t){t="string"!=typeof t?JSON.stringify(t):t;try{t=JSON.parse(t)}catch(t){return!1}return"object"==typeof t&&null!==t}
/**
 * NOTICE OF LICENSE
 *
 * Copyright (c) 2020 Rico Dang. All rights reserved.
 * This work is licensed under the terms of the MIT license.
 * For a copy, see <https://opensource.org/licenses/MIT>.
 *
 * @author     Rico Dang <rico@pgml.de>
 * @copyright  2022 Rico Dang
 * @version    0.1.0
 * @since      07/06/2022
 */;class lazyLoadScripts{constructor(t,e){this.opts=Object.assign({offset:0,onWatch:function(){},onSuccess:function(){},onAllDone:function(){},onFail:function(t){}},e),this.nbrScripts=0,this.nbrStyles=0,"string"==typeof t&&(this.elem=document.querySelectorAll(t)),t.length||(this.elem=[t]);const s=[];this.elem.forEach(((t,e)=>{if(t.dataset.lazyLoadScripts){let o=_isJSON(t.dataset.lazyLoadScripts)?JSON.parse(t.dataset.lazyLoadScripts):[t.dataset.lazyLoadScripts],n=t.dataset.lazyLoadCss||!1;_isJSON(n)?n=JSON.parse(n):!1!==n&&(n=[n]),s[e]={elem:t,inDom:!1,scriptSrc:o,cssSrc:n}}})),this.opts.onWatch.call(s),window.addEventListener("scroll",(()=>{let t=null;if(s.forEach(((e,o)=>{!e.inDom&&this.isInViewport(e.elem)&&(this.opts.onWatch(s),!1!==e.cssSrc&&e.cssSrc.map((t=>this.appendCSS(t))),t=e.scriptSrc.map((t=>this.appendJS(t,this.opts.onSuccess))),s[o].inDom=!0,e.elem.removeAttribute("data-lazy-load-css"),e.elem.removeAttribute("data-lazy-load-scripts"))})),t){Promise.all(t).then(this.opts.onAllDone(this.appendJS))}}))}isInViewport(t){if("hidden"===window.getComputedStyle(t).visibility)return;const e=t.getBoundingClientRect(),s=window.scrollY,o=s+window.outerHeight,n=e.top+document.body.scrollTop;return n+t.offsetHeight>=s-this.opts.offset&&n<=o+this.opts.offset}appendCSS(t,e){const s=document.createElement("link");s.href=t,s.rel="stylesheet",s.type="text/css",s.onload="function"==typeof e?e(200,t,"css"):e,document.body.appendChild(s)}appendJS(t,e){return new Promise((s=>{const o=document.createElement("script");o.src=t,o.type="text/javascript",o.onload="function"==typeof e?e(200,t,"js"):e,document.body.appendChild(o),s(200,t,"js")}))}}