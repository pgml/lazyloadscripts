const _isJSON=function(t){t="string"!=typeof t?JSON.stringify(t):t;try{t=JSON.parse(t)}catch(t){return!1}return"object"==typeof t&&null!==t}
/**
 * NOTICE OF LICENSE
 *
 * Copyright (c) 2020 Rico Dang. All rights reserved.
 * This work is licensed under the terms of the MIT license.
 * For a copy, see <https://opensource.org/licenses/MIT>.
 *
 * @author     Rico Dang <rico@pgml.de>
 * @copyright  2022 Rico Dang
 * @version    0.1.0
 * @since      07/06/2022
 */;class lazyLoadScripts{constructor(t,e){this.opts=Object.assign({offset:0,onWatch:function(){},onSuccess:function(){},onAllDone:function(){},onFail:function(t){}},e),this.nbrScripts=0,this.nbrStyles=0,"string"==typeof t&&(this.elem=document.querySelectorAll(t)),t.length||(this.elem=[t]);const n=[];this.elem.forEach(((t,e)=>{if(t.dataset.lazyLoadScripts){let s=_isJSON(t.dataset.lazyLoadScripts)?JSON.parse(t.dataset.lazyLoadScripts):[t.dataset.lazyLoadScripts],o=t.dataset.lazyLoadCss||!1;_isJSON(o)?o=JSON.parse(o):!1!==o&&(o=[o]),n[e]={elem:t,inDom:!1,scriptSrc:s,cssSrc:o}}})),this.opts.onWatch.call(n),window.addEventListener("scroll",(()=>{let t=null;if(n.forEach(((e,s)=>{!e.inDom&&this.isInViewport(e.elem)&&(this.opts.onWatch(n),!1!==e.cssSrc&&e.cssSrc.map((t=>this.appendCSS(t))),t=e.scriptSrc.map((t=>this.appendJS(t,this.opts.onSuccess))),n[s].inDom=!0,e.elem.removeAttribute("data-lazy-load-css"),e.elem.removeAttribute("data-lazy-load-scripts"))})),t){Promise.all(t).then(this.opts.onAllDone(this.appendJS))}}))}isInViewport(t){if("hidden"===window.getComputedStyle(t).visibility)return;const e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom-this.opts.offset<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}appendCSS(t,e){const n=document.createElement("link");n.href=t,n.rel="stylesheet",n.type="text/css",n.onload="function"==typeof e?e(200,t,"css"):e,document.body.appendChild(n)}appendJS(t,e){return new Promise((n=>{const s=document.createElement("script");s.src=t,s.type="text/javascript",s.onload="function"==typeof e?e(200,t,"js"):e,document.body.appendChild(s),n(200,t,"js")}))}}