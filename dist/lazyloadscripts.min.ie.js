"use strict";function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}var _isJSON=function(t){t="string"!=typeof t?JSON.stringify(t):t;try{t=JSON.parse(t)}catch(t){return!1}return"object"===_typeof(t)&&null!==t};function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}
/**
 * NOTICE OF LICENSE
 *
 * Copyright (c) 2020 Rico Dang. All rights reserved.
 * This work is licensed under the terms of the MIT license.
 * For a copy, see <https://opensource.org/licenses/MIT>.
 *
 * @author     Rico Dang <rico@pgml.de>
 * @copyright  2022 Rico Dang
 * @version    0.1.0
 * @since      07/06/2022
 */var lazyLoadScripts=function(){function t(e,n){var o=this;_classCallCheck(this,t),this.opts=Object.assign({offset:0,onWatch:function(){},onSuccess:function(){},onAllDone:function(){},onFail:function(t){}},n),this.nbrScripts=0,this.nbrStyles=0,"string"==typeof e&&(this.elem=document.querySelectorAll(e)),e.length||(this.elem=[e]);var i=[];this.elem.forEach((function(t,e){if(t.dataset.lazyLoadScripts){var n=_isJSON(t.dataset.lazyLoadScripts)?JSON.parse(t.dataset.lazyLoadScripts):[t.dataset.lazyLoadScripts],o=t.dataset.lazyLoadCss||!1;_isJSON(o)?o=JSON.parse(o):!1!==o&&(o=[o]),i[e]={elem:t,inDom:!1,scriptSrc:n,cssSrc:o}}})),this.opts.onWatch.call(i),window.addEventListener("scroll",(function(){var t=null;if(i.forEach((function(e,n){!e.inDom&&o.isInViewport(e.elem)&&(o.opts.onWatch(i),!1!==e.cssSrc&&e.cssSrc.map((function(t){return o.appendCSS(t)})),t=e.scriptSrc.map((function(t){return o.appendJS(t,o.opts.onSuccess)})),i[n].inDom=!0,e.elem.removeAttribute("data-lazy-load-css"),e.elem.removeAttribute("data-lazy-load-scripts"))})),t)Promise.all(t).then(o.opts.onAllDone(o.appendJS))}))}return _createClass(t,[{key:"isInViewport",value:function(t){if("hidden"!==window.getComputedStyle(t).visibility){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom-this.opts.offset<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}}},{key:"appendCSS",value:function(t,e){var n=document.createElement("link");n.href=t,n.rel="stylesheet",n.type="text/css",n.onload="function"==typeof e?e(200,t,"css"):e,document.body.appendChild(n)}},{key:"appendJS",value:function(t,e){return new Promise((function(n){var o=document.createElement("script");o.src=t,o.type="text/javascript",o.onload="function"==typeof e?e(200,t,"js"):e,document.body.appendChild(o),n(200,t,"js")}))}}]),t}();